<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kosa.metacar.mapper.CarMapper">

	<select id="cargetList"
		resultType="kosa.metacar.dto.Have_CarDTO">
		<![CDATA[
			select * from have_car
		]]>
	</select>

	<!-- private String carType[]; private int zoneType; private String keyword; -->

	<select id="cargetListWithPaging"
		resultType="kosa.metacar.dto.Have_CarDTO">
   	<![CDATA[
			SELECT carNum, carKind, sczonenum, carModel, carMaking FROM
            (SELECT /*+INDEX_DESC(have_car carNum) */
                    ROWNUM rn, carNum, carModel, carMaking, carKind, sczonenum
                    FROM have_car             
					WHERE 
					(
					 	(
						 	carKind = #{carSmall} OR 
							carKind = #{carMiddle} OR 
							carKind = #{carBig} OR 
							carKind = #{carSUV}
						)
						OR
					 	(
						 	NULLIF(#{carSmall}, '') is null AND
							NULLIF(#{carMiddle}, '') is null AND
							NULLIF(#{carBig}, '') is null AND
							NULLIF(#{carSUV}, '') is null
						)
					)
					AND 
					(
						(#{zoneType} = 0) OR
						((#{zoneType} != 0) AND (sczonenum = #{zoneType}))
					)
					AND (carModel LIKE '%'|| #{keyword} ||'%')
					AND rownum <= 20)
        	where rn > 0
	]]>
	</select>

					

</mapper>